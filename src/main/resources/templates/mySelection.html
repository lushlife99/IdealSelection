<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>mySelectionPage</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        .pagination {
            display: flex;
            list-style: none;
            padding: 0;
        }

        .pagination li {
            margin: 0 5px;
        }

        .pagination a {
            text-decoration: none;
            padding: 5px 10px;
            border: 1px solid #ccc;
            border-radius: 3px;
            color: #333;
        }

        .pagination .active {
            background-color: #007BFF;
            color: #fff;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-sm bg-light mb-3">
    <div class="container-fluid">
        <!-- Navigation links -->
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" href="/main">이상형 월드컵</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/create">이상형 월드컵 만들기</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/mySelection">내 월드컵 관리</a>
            </li>
        </ul>

        <!-- Logout button -->
        <ul class="navbar-nav ml-auto">
            <li class="nav-item">
                <a class="nav-link" href="#" onclick="logout()">로그아웃</a>
            </li>
        </ul>

    </div>
</nav>

<div class="wrapper wrapper-content " data-cnt="10">
    <div class="row equal">
        <div class="col-xs-6 col-sm-3 col-lg-2" style="padding:2px; margin-left: 20px">
            <div class="ibox">
                <div class="ibox-content product-box">
                    <div class="product-imitation" style="height:200px;padding:0px">
                        <div style="float:left;width:50%;height:180px;background-image: url('https://img.piku.co.kr/w/uploads/54CAfg/a0b5e7a7b7a1218f9e5fc7b0822ba559.jpg');background-repeat:no-repeat;background-size: cover;background-position: center top;display:flex;">
                        </div>
                        <div style="width:50%;height:180px;background-image: url('https://img.piku.co.kr/w/uploads/54CAfg/9eab5c730645b3d8352a558c30f1b36a.jpg');background-repeat:no-repeat;background-size: cover;background-position: center top;display:flex;">
                        </div>
                        <div style="float:left;color:#676a6c;width:50%;max-height:20px;overflow: hidden; text-overflow: ellipsis;white-space: nowrap;display:inline-block;">btn_plus_pressed</div>
                        <div style="color:#676a6c;width:50%;max-height:20px;overflow: hidden; text-overflow: ellipsis;white-space: nowrap;display:inline-block;">btn_plus_pressed</div>
                    </div>
                    <div class="product-desc" style="cursor:Pointer" data-id="54CAfg">
                        <a href="#" class="product-name" th:text="${selectionList.get(0).getTitle()}">title</a>
                        <div class="small m-t-xs" th:text="${selectionList.get(0).getTitle()}">body</div>
                        <div class="m-t text-righ">
                            <div class="btn-group" data-id="54CAfg">
                                <button type="button" class="btn btn-sm btn-outline btn-info fedit"><i class="fa fa-edit"></i> 수정</button>
                                <button type="button" class="btn btn-sm btn-outline btn-primary fdelete"><i class="fa fa-trash"></i> 삭제</button>
                            </div>
                            <div class="input-group divshare" style="display:none">
                                <span class="input-group-btn">
                                <button type="button" class="btn btn-sm btn-success fcopy"><i class="fa fa-copy"></i>복사</button>
                                </span>
                                <input type="text" class="form-control input-sm shareurl" value="https://www.piku.co.kr/w/54CAfg">
                            </div>
                            <div class="sharemsg"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<ul class="pagination mt-5" id="pagination" th:with="num=(${selectionList.size() % 10 == 0} ? ${selectionList.size() / 10} : ${selectionList.size() / 10 + 1})">
    <li th:if="${pagePrefix != 0}">
        <a href="#" onclick="changePage('prev')">이전</a>
    </li>
    <li th:each="i : ${#numbers.sequence(1, num)}" >
        <a href="#" th:attr="onclick='changePage(' + ${i} + ')'" th:text="(${pagePrefix} + ${i})">0</a>
    </li>
    <li th:if="${selectionList.size() == 100}">
        <a href="#" onclick="changePage('next')">다음</a>
    </li>
</ul>
</body>
</html>

<script th:inline="javascript">

    var currentPage = 1;
    function changePage(page) {
        if (page === 'prev'){
            getPrevPaginationList();
        }
        else if (page === 'next'){
            getNextPaginationList();
        }

        else if (typeof page === 'number') {
            console.log(page);
            currentPage = page;
        }

        // Update the active state of the pagination buttons.
        updatePagination();
    }

    function getNextPaginationList() {
        console.log("next");
        window.location.href = '/mySelection?pagePrefix=' + [[${pagePrefix + 10}]];
    }

    function getPrevPaginationList() {
        console.log("next");
        window.location.href = '/mySelection?pagePrefix=' + [[${pagePrefix - 10}]];
    }


    function updatePagination() {
        var paginationLinks = document.querySelectorAll('.pagination a');
        paginationLinks.forEach(function(link) {
            link.classList.remove('active');
            if (link.innerHTML == currentPage) {
                link.classList.add('active');
            }
        });
    }


    function logout() {
        $.ajax({
            type: 'GET',
            url: '/api/logOut',
            success: function (response) {
                alert("로그아웃");
                window.location.href = '/login';
            },
            error: function (error) {
                alert(error.responseJSON.message);
            }
        });
    }


    function changeSelection(){

    }

    function sortByPopularity() {
        alert("인기순으로 정렬합니다.");
    }

    function sortByLatest() {
        alert("최신순으로 정렬합니다.");
    }

    function search() {
        alert("검색 기능 구현");
    }

    changePage(1);
</script>